<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- Meta and Title -->
        <meta charset="UTF-8">
        <title>Effortless Thumbnail Resizer</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
        <!-- External Icon Library -->
        <script src="https://unpkg.com/@phosphor-icons/web"></script>
    
        <!-- Styles -->
        <style>
            /* CSS Variables for theming */
            :root {
                --background-secondary-color: #F2F4F8;
                --background-primary-color: #FFFFFF;
                --text-color: #333333;
                --text-secondary-color: #666666;
                --border-color: #E0E0E0;
                --primary-color: #18A0FB;
                --hover-color: #E6F7FF;
                --banner-bg-color: #FFFFFF;
                --font-family: 'Inter', sans-serif;
            }
    
            /* Global Styles */
            * {
                box-sizing: border-box;
                margin: 0;
                padding: 0;
            }
    
            body, html {
                font-family: var(--font-family);
                background-color: var(--background-secondary-color);
                color: var(--text-color);
                height: 100%;
                overflow: hidden;
                width: 100%;
            }
    
            .container {
                display: flex;
                flex-direction: column;
                height: 100%;
                padding: 0;
                margin: 0 auto;
                max-width: 450px;
            }
    
            /* Home Page */
            .home-page {
                display: flex;
                flex-direction: column;
                height: 100%;
                position: relative;
                padding-left: 12px;
                padding-right: 12px;
            }
    
            /* Banner Styles */
            .banner {
                position: relative;
                background-color: var(--banner-bg-color);
                border-radius: 0 0 32px 32px;
                padding: 24px;
                margin-bottom: 8px;
            }
    
            .banner-content {
                position: relative;
                z-index: 2;
            }
    
            .banner h1 {
                font-size: 20px;
                margin-bottom: 12px;
                font-weight: 600;
            }
    
            .banner p {
                font-size: 14px;
                color: var(--text-secondary-color);
                margin-bottom: 8px;
                line-height: 1.5;
            }
    
            /* Banner SVG */
            .banner-svg {
                position: absolute;
                bottom: 0;
                right: 0;
                width: 202px;
                height: 144px;
            }
    
            /* Create Button and Buy Coffee Button */
            .banner-buttons {
                display: flex;
                gap: 8px;
            }
    
            .create-button {
                background-color: var(--primary-color);
                color: #FFFFFF;
                border: none;
                padding: 12px 14px;
                border-radius: 50px;
                cursor: pointer;
                font-size: 14px;
                font-weight: 500;
                display: inline-flex;
                align-items: center;
                transition: background-color 0.2s ease;
                text-decoration: none;
                flex: 1 0 0;
            }
    
            .create-button:hover {
                background-color: #3994F0;
            }
    
            .create-button .icon-circle {
                display: flex;
                align-items: center;
                justify-content: center;
                background-color: #FFFFFF;
                border-radius: 50%;
                width: 24px;
                height: 24px;
                margin-right: 8px;
            }
    
            .create-button .icon-circle i {
                color: var(--primary-color);
                font-size: 14px;
            }
    
            .buy-coffee-button {
                display: inline-flex;
                align-items: center;
                padding: 12px 14px;
                border: 1px solid #CCCCCC;
                border-radius: 50px;
                font-size: 14px;
                color: #666;
                text-decoration: none;
                cursor: pointer;
                flex: 1 0 0;
            }
    
            .buy-coffee-button:hover {
                background-color: #F2F4F8;
            }
    
            .buy-coffee-button i {
                margin-right: 8px;
                font-size: 16px;
            }
    
            /* Filter Section */
            /* .filter-wrapper { */
                /* background-color: var(--banner-bg-color); */
                /* border-radius: 24px; */
                /* padding: 16px; */
                /* margin-bottom: 16px; */
            /* } */
    
            .tabs {
                display: flex;
                gap: 8px;
                padding: 8px 0;
            }
    
            .tab {
                padding: 8px 16px;
                cursor: pointer;
                font-size: 14px;
                border-radius: 12px;
                background-color: transparent;
                color: var(--text-secondary-color);
                transition: background-color 0.2s ease;
            }
    
            .tab.active {
                background-color: var(--hover-color);
                color: var(--primary-color);
                font-weight: 500;
            }
            .tab:hover {
                background-color: var(--hover-color);
            }
    
            .filter-input {
                display: flex;
                align-items: center;
                background-color: #ffffff60;
                border-radius: 12px;
                padding: 12px 16px;
                /* margin-top: 12px; */
                margin-bottom: 12px;
                border: 1px solid var(--border-color);
            }
    
            .filter-input input {
                border: none;
                background: transparent;
                color: var(--text-color);
                font-size: 14px;
                margin-left: 8px;
                width: 100%;
                outline: none;
            }

            .filter-input:focus-within {
                outline: none;
                border: 1px solid #18A0FB;
                box-shadow: 0px 0px 0px 2px rgba(24, 160, 251, 0.20);
                background-color: var(--background-primary-color);
            }
    
            /* Preset Grid */
            .scrollable-section {
                flex-grow: 1;
                overflow-y: auto;
                padding-bottom: 64px;
            }
    
            .preset-grid {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
            }
    
            .preset-item {
                background-color: var(--background-primary-color, #FFFFFF);
                border-radius: 8px;
                padding: 12px;
                cursor: pointer;
                transition: background-color 0.2s ease;
                gap: 16px;
            }
            .preset-item:hover{
                padding:0px;
                padding-top: 2px;
                padding-bottom: 2px;
                transform: scale(1.01);
                transition: transform 0.2s ease;
            }
            .preset-content{
                display: flex;
                align-items: flex-end;
            }
             .preset-control{
                width: 100%;
                height: 100%;
                display: flex;
                justify-content: flex-end;
           
             }
             .preset-control:hover {
                background-color: var(--hover-color);
                transform: scale(0.975);
                padding: 12px;
                border-radius: 6px;
                transition: transform 0.2s ease;
             
            }
    

    
            .preset-icon {
                width: 12px;
                height: 12x;
                margin-right: 12px;
                display: flex;
                align-items: center;
                justify-content: center;
                padding-left: 12px;
            }
    
            .preset-info {
                flex-grow: 1;
            }
    
            .preset-name {
                font-size: 13px;
                font-weight: 500;
                margin-bottom: 2px;
            }
    
            .preset-count {
                font-size: 12px;
                color: var(--text-secondary-color);
            }
    
            .preset-arrow {
                color: var(--text-secondary-color);
            }

            .preset-control {
                display: flex;
                flex-direction: column;
                gap: 12px;
                width: 100%;
            }
    
            /* Form Page (New Custom Size) */
            .form-page {
                display: none;
                flex-direction: column;
                height: 100%;
                width: 100%;
                margin: 0 auto;
                padding-bottom: 80px;
            }
    
            .plugin-header {
                background-color: #FFFFFF;
                padding: 16px;
                border-radius: 0 0 24px 24px;
                box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
                margin-bottom: 16px;
                position: sticky;
                top: 0;
                z-index: 10;
            }
    
            .back-button {
                display: flex;
                align-items: center;
                background-color: white;
                border: 1px solid #18A0FB;
                color: #18A0FB;
                border-radius: 50px;
                padding: 8px 12px;
                font-size: 14px;
                cursor: pointer;
                margin-bottom: 12px;
                outline: none;
                transition: background-color 0.2s, color 0.2s;
            }
    
            .back-button:hover {
                border-radius: 60px;
                background: #FFF;
                box-shadow: 0px 0px 0px 3px rgba(24, 160, 251, 0.20);
            }
    
            .back-button .icon-circle {
                display: flex;
                align-items: center;
                justify-content: center;
                background-color: #FFFFFF;
                border-radius: 50%;
                width: 24px;
                height: 24px;
                margin-right: 8px;
            }
    
            .back-button .icon-circle i {
                color: var(--primary-color);
                font-size: 16px;
            }
    
            .header-content {
                display: flex;
                justify-content: space-between;
                align-items: center;
            }
    
            .plugin-title {
                font-size: 18px;
                font-weight: 600;
                margin: 0;
            }
    
            .size-counter {
                background-color: #F2F4F8;
                border-radius: 50%;
                padding: 4px 8px;
                font-size: 14px;
                font-weight: 500;
                display: inline-flex;
                align-items: center;
                justify-content: center;
                min-width: 32px;
                min-height: 32px;
            }
    
            .size-container {
                background-color: white;
                border-radius: 12px;
                padding: 16px;
                margin-bottom: 16px;
                box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
                position: relative;
                transition: box-shadow 0.2s;
            }
    
            .size-container.over {
                background-color: #E6F7FF;
                border: 2px dashed #18A0FB;
                transition: background-color 0.2s;
            }
    
            .size-container:focus-within {
                outline: none;
                border: 1px solid #18A0FB;
                box-shadow: 0px 0px 0px 2px rgba(24, 160, 251, 0.20);
            }
    
            .size-input-group {
                display: flex;
                align-items: center;
                margin-bottom: 12px;
            }
    
            .drag-handle {
                cursor: grab;
                margin-right: 8px;
                color: var(--text-secondary-color);
            }
    
            .size-checkbox {
                margin-right: 8px;
                appearance: none;
                width: 16px;
                height: 16px;
                border: 2px solid #ccc;
                border-radius: 4px;
                position: relative;
                cursor: pointer;
                flex-shrink: 0;
                display: flex;
                align-items: center;
                justify-content: center;
            }
    
            .size-checkbox:checked {
                background-color: var(--primary-color);
                border-color: var(--primary-color);
            }
    
            .size-checkbox:checked::after {
                content: '';
                width: 4px;
                height: 8px;
                border: solid #fff;
                border-width: 0 2px 2px 0;
                transform: rotate(45deg);
                display: inline-block;
                margin-bottom: 2px;
            }
    
            .size-name {
                flex-grow: 1;
                font-size: 16px;
                border: none;
                background: transparent;
                padding: 4px;
                outline: none;
                color: #333;
            }
    
            .delete-button {
                background: none;
                border: none;
                cursor: pointer;
                padding: 4px;
                font-size: 16px;
                border-radius: 4px;
                color: #1C274C;
            }
    
            .delete-button:hover {
                background-color: #FDECEC;
                color: red;
            }
    
            .delete-button svg {
                transition: color 0.2s;
            }
    
            .size-inputs {
                display: flex;
                gap: 12px;
            }
    
            .input-wrapper {
                flex: 1;
                display: flex;
                justify-content: space-between;
                align-items: center;
                background-color: #F2F4F8;
                border-radius: 8px;
                padding: 8px 12px;
            }
    
            .input-wrapper:focus-within {
                box-shadow: 0px 0px 0px 2px rgba(24, 160, 251, 0.20);
            }
    
            .input-wrapper label {
                font-size: 14px;
                color: #666;
                display: flex;
                align-items: center;
            }
    
            .input-wrapper input {
                width: 60px;
                border: none;
                background: transparent;
                font-size: 16px;
                font-weight: 500;
                text-align: right;
                outline: none;
                color: #333;
            }
    
            .input-wrapper .unit {
                font-size: 14px;
                color: #666;
            }
    
            .add-size-wrapper {
                display: flex;
                align-items: center;
                margin: 16px 0;
            }
    
            .add-size-wrapper:before,
            .add-size-wrapper:after {
                content: '';
                flex: 1;
                border-bottom: 1px dashed #ccc;
                margin: 0 8px;
            }
    
            .add-size-button {
                display: flex;
                align-items: center;
                justify-content: center;
                background-color: white;
                border: 1px solid #18A0FB;
                border-radius: 20px;
                padding: 10px 14px;
                font-size: 14px;
                color: #18A0FB;
                cursor: pointer;
                outline: none;
                position: relative;
            }
    
            .add-size-button:hover {
                border-radius: 60px;
                background: #FFF;
                box-shadow: 0px 0px 0px 3px rgba(24, 160, 251, 0.20);
            }
    
            .add-size-button svg {
                margin-right: 8px;
            }
    
            /* Footer Buttons */
            .plugin-footer {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                display: flex;
                gap: 12px;
                padding: 16px;
                background-color: #FFFFFF;
                box-shadow: 0 -1px 3px rgba(0, 0, 0, 0.1);
            }
    
            .button-wrapper {
                flex: 1;
                position: relative;
            }
    
            .footer-button {
                width: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 10px;
                border-radius: 100px;
                font-size: 14px;
                font-weight: 500;
                cursor: pointer;
                border: none;
                outline: none;
                transition: background-color 0.2s, color 0.2s;
            }
    
            .save-sizes {
                background-color: white;
                border: 1px solid #18A0FB;
                color: #18A0FB;
            }
    
            .create-thumbnail {
                background-color: #18A0FB;
                border: none;
                color: white;
            }
    
            .save-sizes:hover:enabled {
                background: #FFF;
                box-shadow: 0px 0px 0px 3px rgba(24, 160, 251, 0.20);
            }
    
            .create-thumbnail:hover:enabled {
                background-color: #3994F0;
            }
    
            .thumbnail-counter {
                background-color: #FFFFFF;
                border: 1px solid #18A0FB;
                border-radius: 50%;
                padding: 4px 8px;
                margin-left: 8px;
                font-size: 12px;
                color: #18A0FB;
                display: inline-flex;
                align-items: center;
                justify-content: center;
                max-width: 24px;
                min-height: 24px;
            }
    
            /* Disabled Button */
            .footer-button:disabled {
                opacity: 0.5;
                cursor: not-allowed;
            }
    
            /* Modal */
            .modal {
                display: none;
                position: fixed;
                z-index: 100;
                left: 0;
                top: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(0,0,0,0.4);
            }
    
            .modal-content {
                background-color: #fefefe;
                margin: 15% auto;
                padding: 20px;
                border: 1px solid #888;
                width: 80%;
                max-width: 400px;
                border-radius: 12px;
                position: relative;
            }
    
            .modal h2 {
                margin-top: 0;
            }
    
            .modal input {
                width: 100%;
                padding: 8px;
                margin: 8px 0;
                border: 1px solid #ddd;
                border-radius: 4px;
            }
    
            .modal-button {
                width: 100%;
                padding: 10px;
                background-color: #18A0FB;
                color: white;
                border: none;
                border-radius: 20px;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                margin-top: 16px;
                outline: none;
            }
    
            .modal-button svg {
                margin-right: 8px;
            }
    
            .close-button {
                position: absolute;
                top: 12px;
                right: 12px;
                background: none;
                border: none;
                font-size: 24px;
                cursor: pointer;
                color: #999;
            }
    
            /* Update button styles for full rounding */
            .footer-button,
            .create-button,
            .buy-coffee-button,
            .modal-button,
            .back-button {
                border-radius: 100px;
            }
    
            /* Remove snackbar styles as we'll use Figma's native notifications */
            #snackbar {
                display: none;
            }
    
            /* Hide scrollbars for webkit browsers */
            ::-webkit-scrollbar {
                width: 0;
                background: transparent;
            }
    
            /* Ensure form page scrolls if content overflows */
            .form-page {
                overflow-y: auto;
                padding-bottom: 80px;
                padding-left: 24px;
                padding-right: 24px;
            }
    
            /* Fixed Footer */
            .fixed-footer {
                position: absolute;
                bottom: 0;
                left: 0;
                right: 0;
                background-color: #FFFFFF;
                padding: 12px 16px;
                text-align: center;
                font-size: 12px;
                color: var(--text-secondary-color, #666666);
                border-top: 1px solid var(--border-color, #E0E0E0);
            }
    
            .fixed-footer a {
                color: var(--primary-color, #18A0FB);
                text-decoration: none;
            }
    
            /* Responsive adjustments */
            @media (max-width: 400px) {
                .preset-grid {
                    grid-template-columns: 1fr;
                }
            }
    
            /* Adjust the plugin footer */
            .plugin-footer {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                display: flex;
                gap: 12px;
                padding: 16px;
                background-color: #FFFFFF;
                box-shadow: 0 -1px 3px rgba(0, 0, 0, 0.1);
            }
    
            /* Ensure the form page has enough bottom padding */
            .form-page {
                padding-bottom: 140px;
            }
    
            /* Figma-style tooltip */
            .tooltip-container {
                position: absolute;
                bottom: calc(100% + 8px);
                left: 50%;
                transform: translateX(-50%);
                z-index: 1000;
                pointer-events: none;
                opacity: 0;
                transition: opacity 0.2s ease-in-out;
            }
    
            .tooltip {
                background-color: #3F3F3F;
                color: #FFFFFF;
                padding: 8px 12px;
                border-radius: 8px;
                font-size: 12px;
                line-height: 16px;
                text-align: center;
                box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.2);
                position: relative;
                width: 200px;
            }
    
            .tooltip::after {
                content: '';
                position: absolute;
                bottom: -6px;
                left: 50%;
                transform: translateX(-50%);
                border-left: 6px solid transparent;
                border-right: 6px solid transparent;
                border-top: 6px solid #3F3F3F;
            }
    
            /* Show tooltip when save button is disabled and hovered */
            .save-sizes:disabled:hover + .tooltip-container {
                opacity: 1;
            }
    
            /* Remove any styles related to the unintended caret */
            .save-sizes::after {
                content: none;
            }
        </style>
    </head>
<body>
    <div class="container">
        <!-- Home Page -->
        <div class="home-page" id="homePage">
            <div class="banner">
                <div class="banner-content">
                    <h1>Effortless Thumbnail Resizer</h1>
                    <p>Quickly set one or many sizes with our powerful Figma plugin.</p>
                    <div class="banner-buttons">
                        <button class="create-button" id="createCustomSize">
                            <span class="icon-circle">
                                <i class="ph ph-plus"></i>
                            </span>
                           New Custom Size
                        </button>
                        <a href="https://donate.stripe.com/4gweZ0dxte8U3gQ9AA" target="_blank" class="buy-coffee-button">
                            <i class="ph ph-coffee"></i>
                            Buy Me a Coffee
                        </a>
                    </div>
                </div>
                <!-- Banner SVG -->
                <!-- Include your SVG content here -->
            </div>

            <!-- Filter Section -->
            <div class="filter-wrapper">
                <div class="tabs">
                    <div class="tab active" data-tab="all">All</div>
                    <div class="tab" data-tab="default">Default</div>
                    <div class="tab" data-tab="custom">Created by Me</div>
                </div>
                <div class="filter-input">
                    <i class="ph ph-magnifying-glass"></i>
                    <input type="text" placeholder="Search" id="filterInput">
                </div>
            </div>

            <!-- Preset Grid -->
            <div class="scrollable-section">
                <div class="preset-grid" id="presetGrid"></div>
            </div>

            <!-- Fixed Footer -->
            <div class="fixed-footer">
                Made by Adebimpe Omolaso. <a href="https://donate.stripe.com/4gweZ0dxte8U3gQ9AA" target="_blank">Donate</a> to support more features! Have a suggestion? <a href="https://forms.gle/f8WWbEYM14BRpwtc7" target="_blank">Request a preset</a>.
            </div>
        </div>

        <!-- Form Page -->
        <div class="form-page" id="formPage">
            <header class="plugin-header">
                <button class="back-button" id="backButton">
                    <span class="icon-circle">
                        <i class="ph ph-arrow-left"></i>
                    </span>
                    Back
                </button>
                <div class="header-content">
                    <h1 class="plugin-title" id="formTitle">New Custom Size</h1>
                    <span class="size-counter" id="sizeCounter">01</span>
                </div>
            </header>

            <div id="sizesContainer">
                <!-- Size inputs will be dynamically added here -->
            </div>

            <div class="add-size-wrapper">
                <button id="addCustomSize" class="add-size-button">
                    <i class="ph ph-plus"></i>
                    Add a Custom Size
                </button>
            </div>

            <!-- Footer Buttons -->
            <footer class="plugin-footer">
                <div class="button-wrapper">
                    <button id="saveSizes" class="footer-button save-sizes" disabled style="gap: 8px;">
                        <!-- SVG Icon -->
                        <svg width="22" height="22" viewBox="0 0 22 22" fill="none">
                            <!-- SVG content --><path d="M1 11.0002C1 6.28611 1 3.92909 2.46447 2.46462C3.70529 1.2238 5.58687 1.03431 9 1.00537M21 11.0002C21 6.28611 21 3.92909 19.5355 2.46462C18.2947 1.2238 16.4131 1.03431 13 1.00537" stroke="#18A0FB" stroke-width="1.5" stroke-linecap="round"/>
<path d="M9 21C6.19974 21 4.79961 21 3.73005 20.455C2.78924 19.9757 2.02433 19.2108 1.54497 18.27C1 17.2004 1 15.8003 1 13C1 10.1997 1 8.79961 1.54497 7.73005C2.02433 6.78924 2.78924 6.02433 3.73005 5.54497C4.79961 5 6.19974 5 9 5H13C15.8003 5 17.2004 5 18.27 5.54497C19.2108 6.02433 19.9757 6.78924 20.455 7.73005C21 8.79961 21 10.1997 21 13C21 15.8003 21 17.2004 20.455 18.27C19.9757 19.2108 19.2108 19.9757 18.27 20.455C17.2004 21 15.8003 21 13 21" stroke="#18A0FB" stroke-width="1.5" stroke-linecap="round"/>
<path d="M11 10L11 16M11 16L13.5 13.5M11 16L8.5 13.5" stroke="#18A0FB" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>

                        </svg>
                        Save Sizes
                    </button>
                    <div class="tooltip-container">
                        <div class="tooltip">Please give each size a name to enable saving.</div>
                    </div>
                </div>
                <div class="button-wrapper">
                    <button id="createThumbnail" class="footer-button create-thumbnail">
                        Create Thumbnail
                        <span class="thumbnail-counter" id="thumbnailCounter">01</span>
                    </button>
                </div>
            </footer>

            <!-- Modal -->
            <div id="saveModal" class="modal">
                <div class="modal-content">
                    <h2>Save New Sizes</h2>
                    <p>Please give a name for your group of sizes before saving.</p>
                    <input type="text" id="groupName" placeholder="Enter name">
                    <button id="addToPresets" class="modal-button create-button">
                        <span class="icon-circle">
                            <i class="ph ph-plus"></i>
                        </span>
                        Add to Sizes Presets
                    </button>
                    <button id="closeModal" class="close-button">&times;</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Script -->
<script>
    // Navigation
const homePage = document.getElementById('homePage');
const formPage = document.getElementById('formPage');
const createCustomSizeBtn = document.getElementById('createCustomSize');
const backButton = document.getElementById('backButton');
const formTitle = document.getElementById('formTitle');

createCustomSizeBtn.addEventListener('click', function() {
    homePage.style.display = 'none';
    formPage.style.display = 'flex';
    formTitle.textContent = 'New Custom Size';
    resetForm();
});

backButton.addEventListener('click', function() {
    formPage.style.display = 'none';
    homePage.style.display = 'flex';
});

// Preset Data (Sorted Alphabetically)
const presets = [
    {
        name: "App Store",
        icon: "app-store-logo", // Ensure this icon is available
        count: 2,
        type: "default",
        sizes: [
            { name: "App Icon", width: 1024, height: 1024 },
            { name: "Screenshot (6.5\" Display)", width: 1242, height: 2688 }
        ]
    },
    {
        name: "Behance",
        icon: "behance-logo",
        count: 2,
        type: "default",
        sizes: [
            { name: "Profile Picture", width: 230, height: 230 },
            { name: "Project Cover", width: 808, height: 632 }
        ]
    },
    {
        name: "Dribbble",
        icon: "dribbble-logo",
        count: 3,
        type: "default",
        sizes: [
            { name: "Profile Picture", width: 300, height: 300 },
            { name: "Shot (Standard)", width: 400, height: 300 },
            { name: "Shot (Retina)", width: 1600, height: 1200 }
        ]
    },
    {
        name: "Facebook",
        icon: "facebook-logo",
        count: 3,
        type: "default",
        sizes: [
            { name: "Profile Picture", width: 170, height: 170 },
            { name: "Cover Photo", width: 820, height: 312 },
            { name: "Shared Image", width: 1200, height: 630 }
        ]
    },
    {
        name: "Google Ads",
        icon: "google-logo",
        count: 3,
        type: "default",
        sizes: [
            { name: "Display Ad", width: 300, height: 250 },
            { name: "Responsive Display Ad (Landscape)", width: 1200, height: 628 },
            { name: "Responsive Display Ad (Square)", width: 1200, height: 1200 }
        ]
    },
    {
        name: "Google My Business",
        icon: "google-logo",
        count: 2,
        type: "default",
        sizes: [
            { name: "Profile Photo", width: 250, height: 250 },
            { name: "Cover Photo", width: 1080, height: 608 }
        ]
    },
    {
        name: "Google Play",
        icon: "google-play-logo",
        count: 3,
        type: "default",
        sizes: [
            { name: "App Icon", width: 512, height: 512 },
            { name: "Feature Graphic", width: 1024, height: 500 },
            { name: "Screenshot (Portrait)", width: 1242, height: 2208 }
        ]
    },
    {
        name: "Instagram",
        icon: "instagram-logo",
        count: 3,
        type: "default",
        sizes: [
            { name: "Profile Picture", width: 110, height: 110 },
            { name: "Feed Post (Square)", width: 1080, height: 1080 },
            { name: "Stories", width: 1080, height: 1920 }
        ]
    },
    {
        name: "LinkedIn",
        icon: "linkedin-logo",
        count: 3,
        type: "default",
        sizes: [
            { name: "Profile Picture", width: 400, height: 400 },
            { name: "Cover Photo", width: 1584, height: 396 },
            { name: "Shared Image", width: 1200, height: 627 }
        ]
    },
    {
        name: "Notion",
        icon: "notion-logo", // Ensure this icon is available
        count: 1,
        type: "default",
        sizes: [
            { name: "Page Icon", width: 280, height: 280 }
        ]
    },
    {
        name: "Pinterest",
        icon: "pinterest-logo",
        count: 3,
        type: "default",
        sizes: [
            { name: "Profile Picture", width: 165, height: 165 },
            { name: "Pin Size (Standard)", width: 1000, height: 1500 },
            { name: "Board Cover", width: 222, height: 150 }
        ]
    },
    {
        name: "Product Hunt",
        icon: "product-hunt-logo",
        count: 2,
        type: "default",
        sizes: [
            { name: "Product Image", width: 240, height: 240 },
            { name: "Gallery Images", width: 1270, height: 760 }
        ]
    },
    {
        name: "Snapchat",
        icon: "snapchat-logo",
        count: 2,
        type: "default",
        sizes: [
            { name: "Profile Picture", width: 1080, height: 1080 },
            { name: "Geofilters", width: 1080, height: 1920 }
        ]
    },
    {
        name: "Spotify",
        icon: "spotify-logo",
        count: 3,
        type: "default",
        sizes: [
            { name: "Profile Picture", width: 750, height: 750 },
            { name: "Playlist Cover", width: 640, height: 640 },
            { name: "Album Art", width: 640, height: 640 }
        ]
    },
    {
        name: "TikTok",
        icon: "tiktok-logo",
        count: 2,
        type: "default",
        sizes: [
            { name: "Profile Photo", width: 200, height: 200 },
            { name: "Video Posts", width: 1080, height: 1920 }
        ]
    },
    {
        name: "Twitch",
        icon: "twitch-logo",
        count: 3,
        type: "default",
        sizes: [
            { name: "Profile Picture", width: 256, height: 256 },
            { name: "Profile Banner", width: 1200, height: 480 },
            { name: "Video Player Banner", width: 1920, height: 1080 }
        ]
    },
    {
        name: "VK",
        icon: "vk-logo",
        count: 3,
        type: "default",
        sizes: [
            { name: "Profile Picture", width: 200, height: 200 },
            { name: "Cover Photo", width: 1590, height: 400 },
            { name: "Post Image", width: 604, height: 340 }
        ]
    },
    {
        name: "WhatsApp",
        icon: "whatsapp-logo",
        count: 2,
        type: "default",
        sizes: [
            { name: "Profile Picture", width: 500, height: 500 },
            { name: "Status Update", width: 1080, height: 1920 }
        ]
    },
    {
        name: "X",
        icon: "x-logo", // Ensure this icon is available
        count: 3,
        type: "default",
        sizes: [
            { name: "Profile Picture", width: 400, height: 400 },
            { name: "Header Image", width: 1500, height: 500 },
            { name: "In-stream Photo", width: 1600, height: 900 }
        ]
    },
    {
        name: "YouTube",
        icon: "youtube-logo",
        count: 3,
        type: "default",
        sizes: [
            { name: "Channel Profile", width: 800, height: 800 },
            { name: "Channel Cover", width: 2560, height: 1440 },
            { name: "Video Thumbnail", width: 1280, height: 720 }
        ]
    }
];

// Custom Presets
let customPresets = [];

function loadCustomPresets() {
    // Load custom presets from localStorage or simulate
    customPresets = []; // Assuming no custom presets initially
}

function getAllPresets() {
    return presets.concat(customPresets);
}

// Render Presets
const presetGrid = document.getElementById('presetGrid');
const tabs = document.querySelectorAll('.tab');
const filterInput = document.getElementById('filterInput');

function getSVGIcon(iconName) {
    return `<i class="ph ph-${iconName}" style="font-size: 20px;"></i>`;
}

function renderPresets(filteredPresets) {
    presetGrid.innerHTML = '';
    filteredPresets.forEach((preset, index) => {
        const presetItem = document.createElement('div');
        presetItem.className = 'preset-item';
        presetItem.setAttribute('data-index', index);
        presetItem.innerHTML = `
            <div class="preset-control">
            <div class="preset-icon">${getSVGIcon(preset.icon)}</div>
            <div class="preset-content">
                <div class="preset-info">
                    <div class="preset-name">${preset.name}</div>
                    <div class="preset-count">${preset.count} sizes</div>
                </div>
                <div class="preset-arrow">
                    <i class="ph ph-caret-right"></i>
                </div>
                </div>
            </div>
        `;
        presetItem.addEventListener('click', () => {
            openPreset(preset);
        });
        presetGrid.appendChild(presetItem);
    });
}

function filterPresets() {
    const activeTab = document.querySelector('.tab.active').dataset.tab;
    const filterText = filterInput.value.toLowerCase();

    const filteredPresets = getAllPresets().filter(preset => {
        const matchesTab = activeTab === 'all' || preset.type === activeTab;
        const matchesFilter = preset.name.toLowerCase().includes(filterText);
        return matchesTab && matchesFilter;
    });

    renderPresets(filteredPresets);
}

// Tabs and Filter Functionality
tabs.forEach(tab => {
    tab.addEventListener('click', () => {
        tabs.forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
        filterPresets();
    });
});

filterInput.addEventListener('input', filterPresets);

// Load and render presets
loadCustomPresets();
filterPresets();

// Size Input Functionality
const sizesContainer = document.getElementById('sizesContainer');
const addSizeButton = document.getElementById('addCustomSize');
const saveSizesButton = document.getElementById('saveSizes');
const createThumbnailButton = document.getElementById('createThumbnail');
const sizeCounterElement = document.getElementById('sizeCounter');
const thumbnailCounterElement = document.getElementById('thumbnailCounter');
const modal = document.getElementById('saveModal');
const closeModal = document.getElementById('closeModal');
const addToPresets = document.getElementById('addToPresets');
const groupNameInput = document.getElementById('groupName');

addSizeButton.addEventListener('click', () => addNewSize());
saveSizesButton.addEventListener('click', saveSizes);
createThumbnailButton.addEventListener('click', createThumbnail);
closeModal.addEventListener('click', () => {
    modal.style.display = 'none';
    groupNameInput.value = '';
});
addToPresets.addEventListener('click', saveGroupSizes);

addNewSize(); // Add initial size input

function addNewSize(size = { name: '', width: 1000, height: 1000 }) {
    const sizeContainer = document.createElement('div');
    sizeContainer.className = 'size-container';
    sizeContainer.setAttribute('draggable', 'true');
    sizeContainer.innerHTML = `
        <div class="size-input-group">
            <span class="drag-handle"><i class="ph ph-dots-six-vertical"></i></span>
            <input type="checkbox" class="size-checkbox" checked>
            <input type="text" class="size-name" placeholder="Size Name" value="${size.name || ''}" required>
            <button class="delete-button" onclick="deleteSize(this)">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path d="M19.5 5.5L18.88 15.525C18.722 18.086 18.643 19.367 18 20.288C17.6826 20.7432 17.2739 21.1273 16.8 21.416C15.843 22 14.56 22 11.994 22C9.424 22 8.139 22 7.18 21.415C6.70589 21.1257 6.29721 20.7409 5.98 20.285C5.338 19.363 5.26 18.08 5.106 15.515L4.5 5.5M3 5.5H21M16.056 5.5L15.373 4.092C14.92 3.156 14.693 2.689 14.302 2.397C14.2151 2.33232 14.1232 2.27479 14.027 2.225C13.594 2 13.074 2 12.035 2C10.969 2 10.436 2 9.995 2.234C9.89752 2.28621 9.80453 2.34642 9.717 2.414C9.322 2.717 9.101 3.202 8.659 4.171L8.053 5.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </button>
        </div>
        <div class="size-inputs">
            <div class="input-wrapper">
                <label for="width${Date.now()}">
                    W
                </label>
                <input type="number" id="width${Date.now()}" value="${size.width}" min="0" required>
                <span class="unit">px</span>
            </div>
            <div class="input-wrapper">
                <label for="height${Date.now()}">
                    H
                </label>
                <input type="number" id="height${Date.now()}" value="${size.height}" min="0" required>
                <span class="unit">px</span>
            </div>
        </div>
    `;
    sizesContainer.appendChild(sizeContainer);

    // Add event listeners
    const sizeNameInput = sizeContainer.querySelector('.size-name');
    sizeNameInput.addEventListener('input', validateSizeNames);

    const checkbox = sizeContainer.querySelector('.size-checkbox');
    checkbox.addEventListener('change', updateCounters);

    // Drag and Drop functionality
    addDragAndDropListeners(sizeContainer);

    validateSizeNames();
    updateCounters();
}

// Drag and Drop Handlers
let dragSrcEl = null;

function handleDragStart(e) {
    dragSrcEl = this;
    e.dataTransfer.effectAllowed = 'move';
    e.dataTransfer.setData('text/html', this.outerHTML);
    this.classList.add('dragging');
}

function handleDragOver(e) {
    e.preventDefault();
    return false;
}

function handleDragEnter(e) {
    this.classList.add('over');
}

function handleDragLeave(e) {
    this.classList.remove('over');
}

function handleDrop(e) {
    e.stopPropagation();
    if (dragSrcEl !== this) {
        const dropHTML = e.dataTransfer.getData('text/html');
        const temporaryDiv = document.createElement('div');
        temporaryDiv.innerHTML = dropHTML;
        const droppedElement = temporaryDiv.firstChild;
        
        // Preserve the name value before removing the original
        const sizeName = dragSrcEl.querySelector('.size-name').value; // Ensure this targets the correct input
        
        sizesContainer.removeChild(dragSrcEl);
        this.insertAdjacentHTML('beforebegin', dropHTML);
        const newElement = this.previousSibling;
        
        // Restore the input value
        newElement.querySelector('.size-name').value = sizeName; // Ensure this targets the correct input
        
        addDragAndDropListeners(newElement);
    }
    this.classList.remove('over');
    return false;
}

function handleDragEnd() {
    this.classList.remove('dragging');
    document.querySelectorAll('.size-container').forEach(item => {
        item.classList.remove('over');
    });
}

function addDragAndDropListeners(element) {
    const dragHandle = element.querySelector('.drag-handle');
    dragHandle.addEventListener('mousedown', (e) => {
        element.setAttribute('draggable', 'true');
    });
    dragHandle.addEventListener('mouseup', (e) => {
        element.setAttribute('draggable', 'false');
    });

    element.addEventListener('dragstart', handleDragStart);
    element.addEventListener('dragenter', handleDragEnter);
    element.addEventListener('dragover', handleDragOver);
    element.addEventListener('dragleave', handleDragLeave);
    element.addEventListener('drop', handleDrop);
    element.addEventListener('dragend', handleDragEnd);
}

function deleteSize(button) {
    button.closest('.size-container').remove();
    updateCounters();
    validateSizeNames();
}

window.deleteSize = deleteSize;

function updateCounters() {
    const sizeContainers = document.querySelectorAll('.size-container');
    const checkedSizes = document.querySelectorAll('.size-checkbox:checked').length;
    sizeCounterElement.textContent = String(sizeContainers.length).padStart(2, '0');
    thumbnailCounterElement.textContent = String(checkedSizes).padStart(2, '0');

    // Enable or disable Create Thumbnail button
    createThumbnailButton.disabled = checkedSizes === 0;
}

function validateSizeNames() {
    let allFilled = true;
    const names = [];
    document.querySelectorAll('.size-name').forEach(input => {
        if (input.value.trim() === '') {
            input.classList.remove('filled');
            allFilled = false;
        } else {
            input.classList.add('filled');
            names.push(input.value.trim());
        }
    });

    // Check for duplicates
    const hasDuplicates = new Set(names).size !== names.length;
    if (hasDuplicates) {
        allFilled = false;
        parent.postMessage({ pluginMessage: { type: 'show-notification', message: 'Size names must be unique.' } }, '*');
    }

    // Enable or disable the save button
    saveSizesButton.disabled = !allFilled;
}

// Update the getSizes function to make size names optional for creating thumbnails
function getSizes() {
    const sizes = [];
    document.querySelectorAll('.size-container').forEach(container => {
        const checkbox = container.querySelector('.size-checkbox');
        if (checkbox.checked) {
            const name = container.querySelector('.size-name').value.trim(); // Size name is now optional
            const width = container.querySelector('input[id^="width"]').value;
            const height = container.querySelector('input[id^="height"]').value;
            if (width && height) {
                sizes.push({ name: name || 'Unnamed', width: parseInt(width), height: parseInt(height) }); // Default name if empty
            }
        }
    });
    return sizes;
}

function saveSizes() {
    const sizes = getSizes();
    if (sizes.length > 1) {
        modal.style.display = 'block';
    } else if (sizes.length === 1) {
        saveGroupSizes();
    } else {
        parent.postMessage({ pluginMessage: { type: 'show-notification', message: 'Please add at least one size before saving.' } }, '*');
    }
}

function saveGroupSizes() {
    const sizes = getSizes();
    if (sizes.length === 0) {
        parent.postMessage({ pluginMessage: { type: 'show-notification', message: 'Please add at least one valid size before saving.' } }, '*');
        return;
    }

    let groupName = groupNameInput.value.trim();
    if (sizes.length > 1 && !groupName) {
        parent.postMessage({ pluginMessage: { type: 'show-notification', message: 'Please enter a name for the group of sizes.' } }, '*');
        return;
    }

    if (sizes.length === 1) {
        groupName = sizes[0].name;
    }

    // Save to custom presets
    customPresets.push({
        name: groupName,
        icon: "lightbulb",
        count: sizes.length,
        type: "custom",
        sizes: sizes
    });

    // Update presets display
    filterPresets();

    // Clear inputs and close modal
    sizesContainer.innerHTML = '';
    addNewSize();
    modal.style.display = 'none';
    groupNameInput.value = '';
    parent.postMessage({ pluginMessage: { type: 'show-notification', message: 'Sizes saved successfully!' } }, '*');
}

function createThumbnail() {
    const sizes = getSizes();
    if (sizes.length === 0) {
        parent.postMessage({ pluginMessage: { type: 'show-notification', message: 'Please select at least one size.' } }, '*');
        return;
    }

    // Send message to plugin code to create thumbnails
    parent.postMessage({ pluginMessage: { type: 'create-thumbnails', sizes } }, '*');
}

// Update the onmessage handler
window.onmessage = (event) => {
    if (event.data.pluginMessage) {
        const message = event.data.pluginMessage;
        if (message.type === 'error' || message.type === 'success') {
            parent.postMessage({ pluginMessage: { type: 'show-notification', message: message.message } }, '*');
        }
    }
};

// Open Preset Functionality
function openPreset(preset) {
    homePage.style.display = 'none';
    formPage.style.display = 'flex';
    formTitle.textContent = preset.name;
    sizesContainer.innerHTML = '';

    preset.sizes.forEach(size => {
        addNewSize(size);
    });
}

function resetForm() {
    sizesContainer.innerHTML = '';
    addNewSize();
}

// Initialize the page
document.addEventListener('DOMContentLoaded', function() {
    updateCounters();
});
</script>
</body>
</html>
